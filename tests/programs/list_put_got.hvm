None =      λnone λsome (none)
Some = λval λnone λsome (some val)

Nil  =       λnil λcons (nil)
Cons = λh λt λnil λcons (cons h t)

// Scott encoding
Succ = λp λs λz (s p)
Zero =    λs λz z

// Scott Nats
S0 = λs λz z
S1 = (Succ S0)
S2 = (Succ S1)
S3 = (Succ S2)
S4 = (Succ S3)
S5 = (Succ S4)
S6 = (Succ S5)
S7 = (Succ S6)
S8 = (Succ S7)
S9 = (Succ S8)
S10 = (Succ S9)
S11 = (Succ S10)
S12 = (Succ S11)
S13 = (Succ S12)
S14 = (Succ S13)
S15 = (Succ S14)
S16 = (Succ S15)
S17 = (Succ S16)
S18 = (Succ S17)
S19 = (Succ S18)
S20 = (Succ S19)
S21 = (Succ S20)
S22 = (Succ S21)
S23 = (Succ S22)
S24 = (Succ S23)
S25 = (Succ S24)
S26 = (Succ S25)
S27 = (Succ S26)
S28 = (Succ S27)
S29 = (Succ S28)
S30 = (Succ S29)
S31 = (Succ S30)
S32 = (Succ S31)

Got = λlist (list GotN GotC)
  GotN =       λindex (None, Nil)
  GotC = λh λt λindex ((index GotS GotZ) h t)
    GotS = λi λh λt
      let (got, t) = (Got t i)
      (got, (Cons h t))
    GotZ =    λh λt ((Some h), (Cons h t))

Put = λlist (list PutN PutC)
  PutN =      λindex (index PutNS PutNZ)
    PutNS = λi λval
      let (old, t) = (PutN i val)
      (old, (Cons None t))
    PutNZ =    λval (None, (Cons val Nil))
  PutC = λh λt λindex ((index PutCS PutCZ) h t)
    PutCS = λi λh λt λval 
      let (old, t) = (Put t i val)
      (old, (Cons h t))
    PutCZ =    λh λt λval ((Some h), (Cons val t))

main = 
  let list = 
  (Cons (Some S0)
  (Cons (Some S1)
  (Cons (Some S2)
  (Cons (Some S3)
  (Cons (Some S4)
  (Cons (Some S5)
  (Cons (Some S6)
  (Cons (Some S7)
  (Cons (Some S8)
  (Cons (Some S9)
  (Cons (Some S10)
  (Cons (Some S11)
  (Cons (Some S12)
  (Cons (Some S13)
  (Cons (Some S14)
  (Cons (Some S15)
  (Cons (Some S16)
  (Cons (Some S17)
  (Cons (Some S18)
  (Cons (Some S19)
  (Cons (Some S20)
  (Cons (Some S21)
  (Cons (Some S22)
  (Cons (Some S23)
  (Cons (Some S24)
  (Cons (Some S25)
  (Cons (Some S26)
  (Cons (Some S27)
  (Cons (Some S28)
  (Cons (Some S29)
  (Cons (Some S30)
  (Cons (Some S31)
    Nil
  )))))
  )))))
  )))))
  )))))
  )))))
  )))))
  ))
  let (element, list) = ({fun} list {args})
  element