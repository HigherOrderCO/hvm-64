@true = (a (* a))
@fals = (* (a a))

@leaf = (a (* ((a b) b)))
@node = (a (b ((a (b c)) (* c))))

@and = ((@andA (@andB a)) a)
@andA = (a a)
@andB = (* @fals)

@gen = (?<(a @genC) b> b)
  & @leaf ~ (@true a)

@genC = ({2 a b} c)
  & @gen ~ (a d)
  & @node ~ (e (d c))
  & @gen ~ (b e)

@all = ((@allA (@allB a)) a)

@allA = (a (b c))
  & @all ~ (a d)
  & @all ~ (b e)
  & @and ~ (d (e c))

@allB = (a a)

@main = R
  & @gen ~ (#22 b)
  & @all ~ (b R)
